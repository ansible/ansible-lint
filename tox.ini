[tox]
minversion = 1.6
envlist = py27-ansible{19,20,21},py{27,36}-ansible{22,23,24,25,26,27,devel},py{27,36}-flake8

[testenv]
deps =
  ansible19: ansible>=1.9.4,<2
  ansible20: ansible>=2.0.0.2,<2.1
  ansible21: ansible>=2.1,<2.2
  ansible22: ansible>=2.2,<2.3
  ansible23: ansible>=2.3,<2.4
  ansible24: ansible>=2.4,<2.5
  ansible25: ansible>=2.5,<2.6
  ansible26: ansible>=2.6,<2.7
  ansible27: ansible>=2.7,<2.8
  ansibledevel: git+https://github.com/ansible/ansible.git
  -rtest-deps.txt
commands = nosetests []
passenv = HOME
# recreate = True

[testenv:py27-flake8]
deps = flake8
commands = python setup.py flake8
usedevelop = True

[testenv:py36-flake8]
deps = flake8
commands = python setup.py flake8
usedevelop = True

[testenv:metadata-validation]
deps =
    collective.checkdocs
    twine
usedevelop = False
# Ref: https://twitter.com/di_codes/status/1044358639081975813
commands =
    python -m setup checkdocs check --metadata --restructuredtext --strict --verbose
    twine check .tox/dist/*
