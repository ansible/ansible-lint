---
- hosts: all

  tasks:
    - name: with_list
      ansible.builtin.debug:
        msg: '{{ item }}'
      loop:
        - one
        - two

    - name: with_items
      ansible.builtin.debug:
        msg: '{{ item }}'
      loop: '{{ items | flatten(levels=1) }}'

    - name: with_indexed_items
      ansible.builtin.debug:
        msg: '{{ index }} - {{ item }}'
      loop: '{{ items | flatten(levels=1) }}'
      loop_control:
        index_var: index

    - name: with_together simple
      ansible.builtin.debug:
        msg: '{{ item.0 }} - {{ item.1 }}'
      loop: '{{ list_one | zip_longest(list_two) | list }}'

    - name: with_together complex
      ansible.builtin.debug:
        msg: '{{ item.0 }} - {{ item.1 }} - {{ item.2 }}'
      loop: '{{ data[0] | zip_longest(*data[1:]) | list }}'
      vars:
        data:
          - [a, b, c]
          - [d, e, f]
          - [g, h, i]

    - name: with_dict
      ansible.builtin.debug:
        msg: '{{ item.key }} - {{ item.value }}'
      loop: '{{ dictionary | dict2items }}'

    - name: with_sequence
      ansible.builtin.debug:
        msg: '{{ item }}'
      loop: '{{ range(0, 4 + 1, 2) | list }}'

    - name: with_subelements
      ansible.builtin.debug:
        msg: '{{ item.0.name }} - {{ item.1 }}'
      loop: "{{ users | subelements('mysql.hosts') }}"

    - name: with_nested
      ansible.builtin.debug:
        msg: '{{ item.0 }} - {{ item.1 }}'
      loop: '{{ list_one | product(list_two) | list }}'

    - name: with_random_choice
      ansible.builtin.debug:
        msg: '{{ my_list | random }}'
